<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>report – DSAN-5000: Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/gu-logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DSAN-5000: Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../report/report.html" aria-current="page"> 
<span class="menu-text">Report</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about_authors/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-technical-details" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Technical details</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-technical-details">    
        <li>
    <a class="dropdown-item" href="../technical-details/data-collection/main.html">
 <span class="dropdown-text">Data-collection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/data-cleaning/main.html">
 <span class="dropdown-text">Data-cleaning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/eda/main.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/unsupervised-learning/main.html">
 <span class="dropdown-text">Unsupervised Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/supervised-learning/main.html">
 <span class="dropdown-text">Supervised Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/progress-log.html">
 <span class="dropdown-text">Progress Log</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../technical-details/llm-usage-log.html">
 <span class="dropdown-text">LLM usage Log</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#section-i.-introduction" id="toc-section-i.-introduction" class="nav-link active" data-scroll-target="#section-i.-introduction">Section I. Introduction</a></li>
  <li><a href="#section-ii.-objective" id="toc-section-ii.-objective" class="nav-link" data-scroll-target="#section-ii.-objective">Section II. Objective</a></li>
  <li><a href="#section-iii.-key-findings" id="toc-section-iii.-key-findings" class="nav-link" data-scroll-target="#section-iii.-key-findings">Section III. Key Findings</a></li>
  <li><a href="#section-iv.-methodology-overview" id="toc-section-iv.-methodology-overview" class="nav-link" data-scroll-target="#section-iv.-methodology-overview">Section IV. Methodology Overview</a></li>
  <li><a href="#section-v.-visualizations" id="toc-section-v.-visualizations" class="nav-link" data-scroll-target="#section-v.-visualizations">Section V. Visualizations</a></li>
  <li><a href="#section-vi.-societalbusiness-implications" id="toc-section-vi.-societalbusiness-implications" class="nav-link" data-scroll-target="#section-vi.-societalbusiness-implications">Section VI. Societal/Business Implications</a></li>
  <li><a href="#section-vii.-call-to-action" id="toc-section-vii.-call-to-action" class="nav-link" data-scroll-target="#section-vii.-call-to-action">Section VII. Call to Action</a></li>
  <li><a href="#section-viii.-conlusion" id="toc-section-viii.-conlusion" class="nav-link" data-scroll-target="#section-viii.-conlusion">Section VIII. Conlusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<p>
&nbsp;
</p>
<h1 style="text-align:center;">
Food for Thought: A Joint Investigating of the Socioeconomic Food Gap and Yelp Ratings in the DC area
</h1>
<p>
&nbsp;
</p>
<p style="text-align:center;">
Lizzie Healy<br>
Rachna Rawalpally
</p>
<p>
&nbsp;
</p>
<p>
&nbsp;
</p>
<p style="text-align:center;">
DSAN 5000<br>
Georgetown University<br>
December 16th, 2024
</p>
<p>
&nbsp;
</p>
<section id="section-i.-introduction" class="level3">
<h3 class="anchored" data-anchor-id="section-i.-introduction">Section I. Introduction</h3>
<p>
The Washington District of Columbia (D.C.) area represents a culturally and economically diverse cohort of people. This diversity is mirrored in the vast and unqiue selection of dining options, ranging from fast-food joints and cafes to steakhouses and fine-dining available for the D.C. native and out-of-towners alike. Just like any large metropolitan area, these establishments are mostly packed in with the shopping and businesses, however, they are also sprinkled throughout the surronding suburban areas. In addition, DC is home to both more affluent and less affluent areas and neighborhoods somewhere in between. This lead us to wonder about the makeup of the local dining options across the socioeconomic specturm. Studying the makeup of successful areas is pertinent to more than just academic research, but is integral to understanding the urban economy and developing strategic city planning to benefit each indivudal in a commmity.
</p>
<p>
As Kuang demonstrated “information on consumption amenities … can improve our implicit market measures of the value of these amenities, and has incremental effect on sales prices of nearby properties” (Kuang 2017). In layman’s terms, there seems to be some correlation between quality restaurants and higher housing prices. Taking this conclusion one step further, we attempt to investigate the direction of the effect, particularly whether better neighborhoods generally have better restaurants.
</p>
<p>
To investigate this question, we had to take a step backward and understand what exactly consitutes a “good” restaurant. This brought up the age old economic problem of finding a way to quantify an objective measure, in this case, quality. Our solution emerged from the world-wide-web in the form of an ever-growing, popular reviewing site by the name of Yelp.com. What Yelp offers is efficiency in decision-making for customers seeking a particular dining experience, at the same providing a space for customers to rave or condemn a restaurant of their choosing. And from these reviews, a rating score is born, hence our quantifiable measure of quality. This paper then branched in an additional direction to delve deeper into the understanding of a Yelp score in order to more accurately answer our initial question regarding better neighborhoods having better restaurants. We needed to verify that a yelp score is a reliable signal of quality.
</p>
<p>
In this report, we will delve into both directions of research, seeking to generate an understanding of the makeup of a Yelp score and the bias of restaurant options in DC. We will address the following questions in order to guide our research:
</p>
<ul>
<li>What factors are most important to a high Yelp Rating score?</li>
<li>Do better neighborhoods (measured by median income) generally have better restaurants (measured by Yelp ratings)?</li>
<li>Are certain types of restaurants more likely to be rated higher on yelp?</li>
<li>Does price of the restaurant factor into Yelp rating?</li>
<li>Is it possible to predict the Yelp rating of a restaurant based on its features?</li>
</ul>
<p>
The following report will begin with the objective in Section II, followed by an outline of the key findings in Section III. In Section V, the methodology will be explained. Section V will delve into the data set and present helpful visualizations to aid in the presntation of the findings. In Sections VI and VII, we will provide the broad implications both societal and business-oriented and offer a call to action. We will conclude in section VIII.
</p>
</section>
<section id="section-ii.-objective" class="level3">
<h3 class="anchored" data-anchor-id="section-ii.-objective">Section II. Objective</h3>
<p>We aim to analyze the trends and patterns of Yelp ratings, determining if there are speicific restaurant qualities that lend to a higher Yelp score. In addition, we aim to determine is there is a food gap present in the DC area in terms of having better restaurants situated in more affluent neighborhoods.</p>
</section>
<section id="section-iii.-key-findings" class="level3">
<h3 class="anchored" data-anchor-id="section-iii.-key-findings">Section III. Key Findings</h3>
<ul>
<li>Certain factors have a strong relationship:
<ul>
<li>The number of reviews and the price range of the food.</li>
<li>The type of cuisine and the restaurant’s Yelp rating.</li>
<li>The median income of the neighborhood and the number of reviews.</li>
</ul></li>
<li>Most Important Factors:
<ul>
<li>The type of cuisine, number of reviews, and the restaurant’s location (latitude and longitude) were the most influential features.</li>
</ul></li>
<li>Insights for Restaurant Success:
<ul>
<li>While location (latitude and longitude) is important, we found that median income in a neighborhood has little impact on food pricing.</li>
<li>The biggest takeaway is that predicting how people rate or choose restaurants on Yelp is challenging because many factors play a role. However, focusing on location, the number of reviews, and the type of cuisine provides a solid foundation for understanding what drives success.</li>
</ul></li>
</ul>
</section>
<section id="section-iv.-methodology-overview" class="level3">
<h3 class="anchored" data-anchor-id="section-iv.-methodology-overview">Section IV. Methodology Overview</h3>
<p>We analyzed over 600 restaurants, bars, and cafes in Washington, DC listed on Yelp. We focused on key details such as price range, Yelp ratings, location, zip code, and type of cuisine. To enhance our analysis, we grouped price ranges and cuisine types and incorporated additional features, such as median income by zip code from the U.S. Census Bureau. These added details allowed us to uncover deeper patterns and trends in the data. By exploring and modeling this information, we aimed to better understand what factors contribute to the success of these businesses and what makes certain establishments stand out.</p>
</section>
<section id="section-v.-visualizations" class="level3">
<h3 class="anchored" data-anchor-id="section-v.-visualizations">Section V. Visualizations</h3>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/eda/main_files/figure-html/cell-5-output-1.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 1:</strong> Density plot of the zipcodes in the DC area. The minimum income is $34,252, the maximum median income is $235,511, which the median income centering around the $125,000 mark.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/eda/main_files/figure-html/cell-7-output-1.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 2:</strong> Distribution of Yelp score ratings for DC area restaurants. The lowest rating is a 2.9, which is given to Harry’s Pub, Casey’s Coffee &amp; Sandwiches, and The Rooftop. The highest rating is a 5.0 belonging to OPO Bar &amp; Lounge. The median score is a 4.1, indicating most of the restaurants in the sample are above average.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/eda/main_files/figure-html/cell-8-output-1.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 3:</strong> The distriubtion of restaurants falling into each manufactured category. Yelp initially places restaurats into over 50 separate categories, thus for clarity and efficiencies sake, we created 10 aggregated categories. The histogram shows that the dataset contains mostly cafes and bars and few entertainment-based eateries, which are establishments that combine food and entertainment such as Puttery, which is a mini golf course offering a full bar and menu and La Cosecha, which is an outdoor and indoor market that offers food choices.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/eda/main_files/figure-html/cell-10-output-1.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 4:</strong> Percentage of restaurants that fall into each Yelp pricing category (1-4 dollar signs). Our sample is heavily skewed towards 2 dollar sign restaurant, indicating an average price per meal per person of $11-30. The dataset has very few high priced restaurants (4’s), which are equal to $61 or more per person per meal price range.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/eda/main_files/figure-html/cell-13-output-1.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 5:</strong> Crosstabulation of Cuisine Types and Price Range. Here we can begin to see the breakdown of yelp ratings, particularly based on the type of cuisine and by extension the type of restaurant. The restaurant are largely spread across the Yelp ratings, however, we do see that bars have the highest and lowest ratings and cafes have the lowest rating. In addition, American style restaurants fall almost entirely in the 4.0 to 4.5 rating range.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/eda/main_files/figure-html/cell-11-output-2.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 6:</strong> Heatmap of the correlations between the numeric variables within the Yelp dataset. We see there are few strong correlations between any variables and the yelp rating score. There is an emerging correlation between the number of reviews and the price of a restaurant, which could preliminarily indicate that more reviews correlates with a higher price range, however, the correlation value is quite small at only 0.18. Importantly, the correlation between median income and yelp rating is extremely small and even slightly negative.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/unsupervised-learning/main_files/figure-html/cell-22-output-1.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 7:</strong> Median Income versus Yelp Rating resultig from K-Means procedure. There are no clear clusters, lots of overlap, and points that are dispersed across both axes. This indicates that there is no strong correlation between the yelp rating and the median income of the area.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/unsupervised-learning/main_files/figure-html/cell-17-output-1.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 8:</strong> T-SNE results with a perplexity value of 50, color-coded by median income levels. There are two emerging clusters near (-10, 15) and near (0,10). This indicates some small relation between the features of the restaurant and the income of the neighborhood, especially when we account for the global structure of the data and look at more broad relationships between points.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/supervised-learning/main_files/figure-html/cell-10-output-1.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 9:</strong> Decision tree predicting the Yelp ratings based on key features in the dataset. The root is longitude and the number of reviews, indicating that these are the most influential features in predicting restaurant ratings. Latitude, number of reviews, and cusine type frequently appear in subsequent splits, further emphasizing their importance. This suggests that geographic features like longitude and latitude, along with number of reviews, are crucial for predicting a restaurant’s rating.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/supervised-learning/main_files/figure-html/cell-17-output-2.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 10:</strong> Feature Importance results of random forest prediction of price range of a restaurant. We observe an accuracy level of 67% in predictig the price range based on the chosen variables (rating, cusiine type, longitude, latitude, and number of reviews). The F1 macro average score is quite low at 0.27, indicating imbalances across different classes.</p>
<h3 style="text-align:center;" class="anchored">
<img src="../technical-details/supervised-learning/main_files/figure-html/cell-18-output-2.png" class="img-fluid" width="300">
</h3>
<p><strong>Figure 11:</strong> Confusion matrix for results of the model attempting to predict restaurant rating, high vs low rating. The key factors found ot be influencing this prediction were median income, latitude, and longitude, with an overall accuracy of 70%. The model yields precision of 69% and recall of 95% when precting high rating restaurants. The model drops to 77% precision and 29% recall for low rating restaurants. This indicates that many restaurants with lower ratings are being misclassified as having high rating, highlighting an imbalance in the predictions.</p>
</section>
<section id="section-vi.-societalbusiness-implications" class="level3">
<h3 class="anchored" data-anchor-id="section-vi.-societalbusiness-implications">Section VI. Societal/Business Implications</h3>
<p>This study set out to determine what is driving Yelp restaurant ratings and whether there is bias in terms of better restaurants being situated in better neighborhoods. What we found is that the old adage: “location, location, location” does hold some water. The precise location of a restaurant is marginally important, however, the makeup of that surronding area, particularly the economic status, is only minorly important to achieving restaurant success. The type of food being served is crucial as well: finding the correct type of food to serve, either in terms of understanding what is popular in certain areas or finding that gap in the market and filling it, can boost success. Further, what does seem to matter most is exposure: more reviews typically equals a higher rating. This is almost unsuprising, as we continue to charge on in the age of social media, that online exposure can make or break a business. Both from a social and business perspective, our findings lead to a need for a expansive marketing strategy, one that includes reaching as many people as possible. This may be more of a comment on society as whole, than the restaurant industry alone, but it seems both are headed in the direction of online influence being the driver of success. Reaching the easily persuadable demographic could lead to almost immediate success, however, the question remains whether that success is long-term.</p>
</section>
<section id="section-vii.-call-to-action" class="level3">
<h3 class="anchored" data-anchor-id="section-vii.-call-to-action">Section VII. Call to Action</h3>
<ul>
<li>Restaurants should prioritize generating reviews, as having more reviews increases visibility and success. Encouraging customers to leave reviews by offering discounts.</li>
<li>Location continues to be a critical factor. Since Washington, D.C. is a major tourist destination, restaurants should aim to be near metro and bus stations and close to popular tourist attractions.</li>
<li>Selecting a popular or trending cuisine can enhance a restaurant’s potential. Offering dishes that appeal to local tastes can draw in more customers.</li>
<li>Neighborhood Income Doesn’t Determine Pricing: Median income in the neighborhood does not have a strong impact on restaurant pricing, so it’s wise to offer a broad range of prices to attract a wider audience.</li>
<li>By focusing on these key factors—generating reviews and having flexible pricing, restaurants can improve their chances of standing out on Yelp and thriving in the competitive D.C. food scene.</li>
</ul>
</section>
<section id="section-viii.-conlusion" class="level3">
<h3 class="anchored" data-anchor-id="section-viii.-conlusion">Section VIII. Conlusion</h3>
<p>In this project, we found that the type of cuisine, number of reviews, and the restaurant’s location were the most important features for predicting Yelp ratings. Specifically, higher ratings and prices were more strongly associated with factors such as review count, cuisine, and location, while the median income of the neighborhood had no significant impact on pricing. These insights highlight the key factors that can help restaurants thrive in Washington, D.C. Understanding these patterns allows restaurants to pinpoint areas for improvement and focus on what truly matters. As highlighted in one article, restaurant success contributes significantly to local economic growth and employment rates. In today’s data-driven world, it is essential for restaurants to use these insights to their advantage. Our findings align with trends observed in other studies. For example, one article identified location as the second most important factor for success, further emphasizing its importance. Similarly, both our analysis and prior research show that the number of reviews greatly benefits restaurants by boosting their visibility and credibility. However, predicting restaurant success remains challenging because it depends on many variables. For instance, one study focused on college towns revealed that reviews played a smaller role in those areas, suggesting that the significance of certain factors can vary by context. To further expand this research, it would be valuable to analyze specific reviews to identify key words or themes that contribute to positive or negative ratings. Examining photos shared by customers, as well as exploring factors like takeout, delivery options, and visit timing, could provide deeper insights. Additionally, extending this analysis to nearby cities in Virginia and Maryland would offer a broader perspective. This project provides a strong foundation for understanding the complexities of restaurant success on Yelp and presents numerous opportunities for future exploration.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>